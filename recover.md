# Database Recovery Guide

This guide provides steps to recover your data using the `backup_data.sql` file generated by the system backup tool.

## Prerequisites
- PostgreSQL installed and running.
- Access to the database terminal (`psql`) or a GUI tool (pgAdmin, DBeaver).
- Node.js installed (for Prisma commands).

## Recovery Steps

> [!WARNING]
> These steps will OVERWRITE existing data if you are restoring to an existing database. It is highly recommended to perform these steps on a clean database.

### 1. Prepare the Schema
Ensure your database schema is up-to-date with the latest version. In the `server` directory, run:
```bash
npx prisma db push
```
This will create all necessary tables without deleting existing data. If you want a fresh start, you can use:
```bash
npx prisma migrate reset
```
*(Warning: `reset` will delete everything currently in the DB)*

### 2. Import Data
Once the tables are created, you can import the data from your backup file.

#### Using Command Line (psql)
If `psql` is not recognized, you may need to use the full path to the PostgreSQL `bin` directory. For example:

**On Windows:**
1. First, open PowerShell and navigate to the folder where your backup file is (e.g., `cd Desktop`).
2. Run the command:
```powershell
& "C:\Program Files\PostgreSQL\17\bin\psql.exe" -U postgres -d banking_app_backup -f backup_data.sql
```

*Alternatively, use the full path to the file:*
```powershell
& "C:\Program Files\PostgreSQL\17\bin\psql.exe" -U postgres -d banking_app_backup -f "C:\Users\win10\Desktop\backup_data.sql"
```

*(Note: Replace `17` with your actual PostgreSQL version if different)*

#### Using pgAdmin / GUI
1. Open the Query Tool for your database.
2. Open the `backup_data.sql` file.
3. Execute the script.

### 3. Verify Recovery
Navigate to the application dashboard and check if all members, transactions, and loans are visible.

## Important Note on Excel
The `.xlsx` file included in the backup ZIP is for **manual reference** and reporting. Currently, the system does not support automated recovery directly from the Excel file. Always use the `.sql` file for full system recovery.
